---   
layout: post   
title: "üé∞ OLTP v√† OLAP so s√°nh"   
date: 2022-11-12 20:14:52.000000000 -08:00   
type: post   
parent_id: '0'   
published: true   
password: ''   
status: publish   
categories:   
- IT
- System   
tags: []   
author: thu4nvd   
---   
# OLTP v√† OLAP so s√°nh

Trong vi·ªác ph√°t tri·ªÉn c∆° s·ªü d·ªØ li·ªáu quan h·ªá th∆∞·ªùng c√≥ hai chi·∫øn l∆∞·ª£c ch√≠nh l√† **OLTP (On-line transactional processing)** v√† **OLAP (On-line analytical processing)**. V·∫≠y ch√∫ng l√† g√¨, gi·ªëng nhau v√† kh√°c nhau nh∆∞ th·∫ø n√†o?  
Ch√∫ng ta h√£y c√πng t√¨m hi·ªÉu th√¥ng qua m·ªôt h·ªá th·ªëng th·ª±c.   

## TLDR Comparison - D√†nh cho ng∆∞·ªùi kh√¥ng mu·ªën ƒë·ªçc nhi·ªÅu   
![comparison](https://images.viblo.asia/5aa022c4-1d6e-4abf-9179-ec5118184811.png)

## OLTP l√† g√¨?   
OLTP l√† vi·∫øt t·∫Øt c·ªßa **On-line transactional processing**, kh√°i ni·ªám n√†y kh√¥ng kh√≥ ƒë·ªÉ n·∫Øm b·∫Øt. C√°c h·ªá th·ªëng OLTP l√† c√°c h·ªá th·ªëng ‚Äúc·ªï ƒëi·ªÉn‚Äù x·ª≠ l√Ω c√°c giao d·ªãch d·ªØ li·ªáu. Ch√∫ng ƒëang ·ªü xung quanh b·∫°n. Trong ng√¢n h√†ng, m√°y ATM ho·∫∑c h·ªá th·ªëng m√°y t√≠nh ƒë∆∞·ª£c nh√¢n vi√™n ng√¢n h√†ng s·ª≠ d·ª•ng ƒë·ªÉ ghi l·∫°i m·ªôt giao d·ªãch l√† m·ªôt h·ªá th·ªëng OLTP, th∆∞·ªùng l√† m·ªôt c∆° s·ªü d·ªØ li·ªáu. N·∫øu b·∫°n nh·∫Øn tin cho ai ƒë√≥ t·ª´ ƒëi·ªán tho·∫°i th√¥ng minh, b·∫°n ƒëang l√†m vi·ªác v·ªõi m·ªôt h·ªá th·ªëng OLTP kh√°c. S·ªï ti·ªÅn m·∫∑t t·∫°i si√™u th·ªã l·∫°i ch·∫°y tr√™n m·ªôt h·ªá th·ªëng OLTP kh√°c n·ªØa.   

T√≥m l·∫°i, h·∫ßu h·∫øt c√°c ·ª©ng d·ª•ng kinh doanh ƒë·ªÅu l√† c√°c h·ªá th·ªëng OLTP. Th·∫≠t kh√≥ ƒë·ªÉ t∆∞·ªüng t∆∞·ª£ng m·ªôt lƒ©nh v·ª±c computer engineering m√† kh√¥ng c√≥ m·ªôt s·ªë h√¨nh th·ª©c c·ªßa OLTP. Tr√™n th·ª±c t·∫ø, to√†n b·ªô ng√†nh khoa h·ªçc m√°y t√≠nh ƒë√£ l·ªõn l√™n xung quanh nhu c·∫ßu x·ª≠ l√Ω giao d·ªãch m·ªôt c√°ch c√≥ tr·∫≠t t·ª±.   

Do ƒë√≥ ch√∫ng ta ƒëi ƒë·∫øn ph·∫ßn quan tr·ªçng c·ªßa t·ª´ vi·∫øt t·∫Øt trong OLTP: T, vi·∫øt t·∫Øt c·ªßa transactional. C√°c giao d·ªãch r·∫•t quan tr·ªçng v√† vi·ªác gi·ªØ ch√∫ng m·ªôt c√°ch c√≥ t·ªï ch·ª©c c≈©ng r·∫•t quan tr·ªçng.   
Ph·∫£i l√†m g√¨ ƒë·ªÉ gi·ªØ cho c√°c giao d·ªãch c√≥ t·ªï ch·ª©c? ƒê√≥ l√† c√°c c∆° s·ªü d·ªØ li·ªáu giao d·ªãch ph·∫£i ·ªïn ƒë·ªãnh (kh√¥ng d·ªÖ thay ƒë·ªïi), ƒë·ªôc l·∫≠p, nh·∫•t qu√°n v√† nguy√™n t·ª≠ (kh√¥ng d·ªÖ ph√¢n chia).   

N√≥i m·ªôt c√°ch ƒë∆°n gi·∫£n, lo·∫°i giao d·ªãch n√†y ƒë·∫£m b·∫£o r·∫±ng c√°c ho·∫°t ƒë·ªông ƒë∆∞·ª£c th·ª±c hi·ªán b·ªüi nh·ªØng ng∆∞·ªùi d√πng kh√°c nhau kh√¥ng can thi·ªáp v√†o nhau. Ch·∫≥ng h·∫°n, n·∫øu v·ª£ ch·ªìng m·ªói ng∆∞·ªùi r√∫t ti·ªÅn t·ª´ t√†i kho·∫£n ng√¢n h√†ng chung, c√°c giao d·ªãch ph·∫£i ƒë·∫£m b·∫£o r·∫±ng h·ªç kh√¥ng r√∫t ti·ªÅn nhi·ªÅu h∆°n t√†i kho·∫£n c·ªßa m√¨nh.   

M·ªôt h·ªá th·ªëng OLTP c·∫ßn c√°c thu·ªôc t√≠nh n√†y ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng m·ªçi th·ª© ƒëang ho·∫°t ƒë·ªông m·ªôt c√°ch c√≥ tr·∫≠t t·ª±. Khi b·∫°n s·ª≠ d·ª•ng ng√¢n h√†ng, b·∫°n tin t∆∞·ªüng r·∫±ng s·ªë ti·ªÅn b·∫°n g·ª≠i v√†o t√†i kho·∫£n c·ªßa b·∫°n, kh√¥ng b·ªã l·∫´n l·ªôn v·ªõi c√°c giao d·ªãch kh√°c c·ªßa b·∫°n hay b·ªã m·∫•t.   
R√µ r√†ng, qu√° tr√¨nh x·ª≠ l√Ω giao d·ªãch l√† r·∫•t quan tr·ªçng ƒë·ªëi v·ªõi to√†n x√£ h·ªôi c·ªßa ch√∫ng ta.   

## C√≤n OLAP l√† g√¨?   
OLAP l√† vi·∫øt t·∫Øt c·ªßa **On-line analytical processing**. Ch·ªØ c√°i ch√¨a kh√≥a ·ªü ƒë√¢y l√† analytical c≈©ng cho ch√∫ng ta bi·∫øt h·ªá th·ªëng OLAP l√†m g√¨. M·ªôt h·ªá th·ªëng OLAP ƒë∆∞·ª£c d√πng ƒë·ªÉ ph√¢n t√≠ch d·ªØ li·ªáu m·ªôt c√°ch hi·ªáu qu·∫£.   

Kh√¥ng gi·ªëng nh∆∞ OLTP, c√°c h·ªá th·ªëng OLAP l√†m vi·ªác v·ªõi m·ªôt l∆∞·ª£ng d·ªØ li·ªáu r·∫•t l·ªõn. B·∫£o ƒë·∫£m t√≠nh ch√≠nh x√°c v√† t√≠nh to√†n v·∫πn c·ªßa c√°c giao d·ªãch kh√¥ng ph·∫£i l√† m·ª•c ƒë√≠ch c·ªßa ch√∫ng; ƒëi·ªÅu n√†y tr√°i ng∆∞·ª£c v·ªõi OLTP. OLAP l√† ·ªü ƒë√¢y ƒë·ªÉ cho ph√©p ch√∫ng ta t√¨m ra xu h∆∞·ªõng, ƒëi·ªÉm m·∫•u ch·ªët trong m·ªôt big picture. C√°c h·ªá th·ªëng OLAP c√≥ m·ªôt nh√≥m ng∆∞·ªùi d√πng nh·ªè h∆°n so v·ªõi c√°c h·ªá th·ªëng OLTP, th∆∞·ªùng l√† nh·ªØng nh√† ph√¢n t√≠ch ho·∫∑c qu·∫£n l√Ω. V√≠ d·ª•: b·∫°n s·∫Ω kh√¥ng t∆∞∆°ng t√°c v·ªõi h·ªá th·ªëng OLAP c·ªßa ng√¢n h√†ng v√¨ n√≥ ghi l·∫°i c√°c giao d·ªãch t√†i kho·∫£n c·ªßa b·∫°n.   

Ho·∫°t ƒë·ªông ch·ªß y·∫øu trong c√°c c√°c h·ªá th·ªëng OLAP l√† c√°c truy v·∫•n d·ªØ li·ªáu, Ch√∫ng th∆∞·ªùng l√† c√°c truy v·∫•n l·ªõn v√† m·∫•t nhi·ªÅu th·ªùi gian ƒë·ªÉ th·ª±c hi·ªán. Ng∆∞·ª£c l·∫°i, c√°c h·ªá th·ªëng OLTP s·ª≠ d·ª•ng c√°c l·ªánh ph·ªï bi·∫øn nh∆∞ INSERT v√† DELETE. V√† ch√∫ng kh√¥ng n√™n qu√° l√¢u.   
K√≠ch th∆∞·ªõc c·ªßa h·ªá th·ªëng c≈©ng l√† m·ªôt ƒëi·ªÉm kh√°c nhau c∆° b·∫£n gi·ªØa c√°c h·ªá th·ªëng OLTP v√† OLAP. OLTP ph·∫£i ·ªïn ƒë·ªãnh v√† nhanh ch√≥ng (ƒë·ªÉ th·ª±c hi·ªán c√°c c√¥ng vi·ªác th·ªùi gian th·ª±c), trong khi OLAP ph·∫£i ƒë·ªß l·ªõn v√† ƒë·ªß m·∫°nh ƒë·ªÉ l∆∞u tr·ªØ t·∫•t c·∫£ c√°c d·ªØ li·ªáu kinh doanh.   

## M·ªôt v√≠ d·ª• OLTP th·ª±c t·∫ø   
Ch√∫ng ta h√£y xem x√©t s·ª± kh√°c bi·ªát gi·ªØa OLAP v√† OLTP b·∫±ng c√°ch s·ª≠ d·ª•ng c√°c v√≠ d·ª• th·ª±c t·∫ø.   
H√£y nh·ªõ r·∫±ng c√°c truy v·∫•n OLTP ƒë∆°n gi·∫£n v√† nh·ªè h∆°n nhi·ªÅu so v·ªõi nh·ªØng g√¨ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c h·ªá th·ªëng OLAP. Ch√∫ng ta c·∫ßn ph·∫£i th·ª±c hi·ªán c√°c truy v·∫•n OLTP m·ªôt c√°ch nhanh ch√≥ng v·ªõi s·ªë row nh·ªè. V√≠ d·ª• n√†y s·∫Ω xem x√©t m√¥ h√¨nh thanh to√°n t√†i ch√≠nh OLTP ƒë∆°n gi·∫£n.   

Ch√∫ng ta c√≥ c√°c b·∫£ng d·ªØ li·ªáu customer, contract v√† payment. C√πng v·ªõi ƒë√≥ l√† c√°c b·∫£ng quan h·ªá v√† c√°c b·∫£ng detail nh∆∞ trong h√¨nh d∆∞·ªõi.   

![vidu](https://images.viblo.asia/36311ec6-7037-4432-b8b0-720483047837.jpg)

 Gi·∫£ s·ª≠ ch√∫ng ta c·∫ßn ph·∫£i ch√®n m·ªôt kho·∫£n thanh to√°n l√† $5.000 v√†o s·ªë t√†i kho·∫£n 1112 cho m·ªôt kh√°ch h√†ng c√≥ ID l√† 11. ƒêi·ªÅu g√¨ s·∫Ω x·∫£y ra?   

Khi giao d·ªãch n√†y ƒëang ƒë∆∞·ª£c x·ª≠ l√Ω, c√≥ nhi·ªÅu giao d·ªãch kh√°c ƒëang ƒë∆∞·ª£c th·ª±c hi·ªán c√πng m·ªôt l√∫c. Trong m·ªôt h·ªá th·ªëng OLTP ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë√∫ng c√°ch, ƒëi·ªÅu n√†y kh√¥ng c√≥ v·∫•n ƒë·ªÅ. Kh√¥ng c√≥ xung ƒë·ªôt n√†o x·∫£y ra, t·∫•t c·∫£ m·ªçi th·ª© ƒëang ti·∫øn h√†nh m·ªôt c√°ch tu·∫ßn t·ª±.   
B√¢y gi·ªù ch√∫ng ta h√£y xem m·ªôt truy v·∫•n OLTP ƒëi·ªÉn h√¨nh, hi·ªÉn th·ªã d·ªØ li·ªáu c√≥ li√™n quan ƒë·∫øn ng∆∞·ªùi d√πng. Gi·∫£ s·ª≠ ai ƒë√≥ c√≥ ID kh√°ch h√†ng l√† ‚Äú11‚Äù mu·ªën xem 10 giao d·ªãch cu·ªëi c√πng c·ªßa h·ªç:  
![vidu2](https://images.viblo.asia/40c5919d-cd69-4fd6-a858-6c81011d0012.jpg)   
Ho·∫∑c c√≥ th·ªÉ c√πng kh√°ch h√†ng ƒë√≥ mu·ªën xem th√¥ng tin v·ªÅ h·ª£p ƒë·ªìng c√≥ trong h·ªì s∆° c·ªßa t·ªï ch·ª©c t√†i ch√≠nh:   
![vidu3](https://images.viblo.asia/da8ad98d-7a53-4bee-84ac-eedd4b12bea8.jpg)  
ƒêi·ªÅu quan tr·ªçng ch√∫ng ta nh·∫≠n th·∫•y ·ªü ƒë√¢y l√† c√°c truy v·∫•n nh·ªè, nhanh v√† nguy√™n t·ª≠.   

## V√† m·ªôt v√≠ d·ª• OLAP th·ª±c t·∫ø   

Ch√∫ng ta h√£y nh√¨n v√≠ d·ª• tr√™n ·ªü m·ªôt view kh√°c, OLAP. N√≥ ƒë∆∞·ª£c thi·∫øt k·∫ø ·ªü d·∫°ng Star ƒë∆°n gi·∫£n v√† ƒë∆∞·ª£c d√πng ƒë·ªÉ h·ªó tr·ª£ b√°o c√°o v√† ph√¢n t√≠ch.   

![vidu](https://images.viblo.asia/7cdf415a-91e8-49ab-950d-c0528524c10b.jpg)
Trong model n√†y ch√∫ng ta s·ª≠ d·ª•ng m·ªôt b·∫£ng fact trung t√¢m fact_balance ch·ª©a th√¥ng v·ªÅ balance c·ªßa kh√°ch h√†ng theo ng√†y, theo h·ª£p ƒë·ªìng v√† ba b·∫£ng dimension dim_customer, dim_contract, dim_date.   

D·ªØ li·ªáu ƒë∆∞·ª£c ƒë∆∞a v√†o m√¥ h√¨nh OLAP kh√¥ng gi·ªëng nh∆∞ c√°c m√¥ h√¨nh OLTP. Thay v√¨ thu th·∫≠p th√¥ng tin t·ª´ng ch√∫t m·ªôt trong t·ª´ng l·∫ßn c·∫≠p nh·∫≠t giao d·ªãch, OLAP ƒë∆∞·ª£c l·∫•p ƒë·∫ßy b·ªüi c√°c truy v·∫•n theo l√¥, qu√©t to√†n b·ªô model ngu·ªìn (th∆∞·ªùng l√† m·ªôt h·ªá th·ªëng OLTP) v√† nh·∫≠p d·ªØ li·ªáu v√†o m√¥ h√¨nh OLAP. R√µ r√†ng, c√°c c√¢u l·ªánh INSERT cho OLAP l·ªõn h∆°n v√† ch·∫≠m h∆°n b·ªüi v√¨ ch√∫ng bao g·ªìm nhi·ªÅu b·∫£ng ngu·ªìn. Qu√° tr√¨nh ƒë∆∞a d·ªØ li·ªáu v√†o h·ªá th·ªëng OLAP t·ª´ c√°c h·ªá th·ªëng ngu·ªìn ƒë∆∞·ª£c g·ªçi l√† ETL (extract-transform-load).   

Ch√∫ng ta h√£y t·∫°o m·ªôt truy v·∫•n ETL ƒë∆°n gi·∫£n ƒë·ªÉ ƒë∆∞a d·ªØ li·ªáu v√†o c√°c b·∫£ng c·ªßa m√¥ h√¨nh OLAP. Ch·∫≥ng h·∫°n v·ªõi b·∫£ng dim_customer:   
![vidu](https://images.viblo.asia/d2c3e7fa-23ee-48c0-8dfd-4fd680831832.jpg)  

Nh∆∞ c√°c b·∫°n th·∫•y, ch√∫ng ta ƒëang s·ª≠ d·ª•ng nhi·ªÅu b·∫£ng ƒë·ªÉ ƒë∆∞a d·ªØ li·ªáu v√†o m·ªôt b·∫£ng dimension. C√°c truy v·∫•n ph·ª©c t·∫°p th∆∞·ªùng xuy√™n x·∫£y ra ƒë·ªëi v·ªõi c√°c h·ªá th·ªëng OLAP.   
Ch√∫ng ta c√≥ th·ªÉ ƒë∆∞a d·ªØ li·ªáu v√†o b·∫£ng dim_contract theo c√°ch t∆∞∆°ng t·ª±. Tuy nhi√™n, ch√∫ng ta s·∫Ω kh√¥ng ƒë∆∞a d·ªØ li·ªáu v√†o b·∫£ng dim_date, v√¨ n√≥ ƒë∆∞·ª£c x√°c ƒë·ªãnh tr∆∞·ªõc trong c∆° s·ªü d·ªØ li·ªáu v√† ng√†y th√°ng c·ªßa n√≥ kh√¥ng thay ƒë·ªïi. ƒê·ªëi v·ªõi b·∫£ng fact_balance, qu√° tr√¨nh ƒëi·ªÅn th√¥ng tin ph·ª©c t·∫°p h∆°n r·∫•t nhi·ªÅu. T·∫•t c·∫£ nh·ªØng g√¨ ch√∫ng ta c·∫ßn bi·∫øt l√† fact_balance ch·ª©a s·ªë d∆∞ t√†i kho·∫£n v√†o c√°c kho·∫£ng th·ªùi gian c·ª• th·ªÉ.   

N·∫øu nh∆∞ OLTP l√† m·ªôt tuy·∫øn ƒë∆∞·ªùng ch·∫°y tr∆°n tru v·ªõi nhi·ªÅu lo·∫°i xe t∆∞∆°ng t·ª± nhau, th√¨ tuy·∫øn ƒë∆∞·ªùng OLAP l√† m·ªôt n∆°i h·ªón ƒë·ªôn v·ªõi nh·ªØng chi·∫øc xe l·∫° l√πng ƒëang di chuy·ªÉn ·ªü c√°c t·ªëc ƒë·ªô kh√°c nhau. N√≥ kh√¥ng th·ªëng nh·∫•t trong b·∫•t k·ª≥ kh√≠a c·∫°nh n√†o: c√≥ nh·ªØng chi·∫øc xe √¥ t√¥ to l·ªõn m√† kh√¥ng ai nh√¨n th·∫•y tr∆∞·ªõc ƒë√≥ (truy v·∫•n ad-hoc), xe √¥ t√¥ ch·∫≠m v√† l·ªõn m√† ch√∫ng ta th·∫•y th∆∞·ªùng xuy√™n (b√°o c√°o h√†ng th√°ng) v√† th·∫≠m ch√≠ c√≥ nh·ªØng con th√∫ kh√°c.   

M·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh c·ªßa truy v·∫•n OLAP l√† ƒë∆∞a ra s·ªë d∆∞ trung b√¨nh m·ªói qu√Ω cho t·∫•t c·∫£ ng∆∞·ªùi d√πng:     
![vidu](https://images.viblo.asia/08aa0bbb-2655-48b2-8c97-ef154ec4a36c.jpg)  

M·ªôt truy v·∫•n OLAP kh√°c c√≥ th·ªÉ hi·ªÉn th·ªã th√¥ng tin t·ªïng h·ª£p c·ªßa t·∫•t c·∫£ kh√°ch h√†ng sinh ra sau nƒÉm 1990:   

![vidu](https://images.viblo.asia/d00b3e1d-93da-43fa-8094-d8be98bd6895.jpg)   

C√°c truy v·∫•n OLAP th∆∞·ªùng ·ªü d·∫°ng t·ªïng h·ª£p th√¥ng tin c·ªßa t·∫•t c·∫£ d·ªØ li·ªáu c·ªßa m·ªôt t·∫≠p h·ª£p con c·ª• th·ªÉ. Ch·∫≥ng h·∫°n, ch√∫ng ta ƒëang t√¨m ki·∫øm c√°c xu h∆∞·ªõng, gi√° tr·ªã trung b√¨nh, t·ªïng h·ª£p ‚Ä¶ C√°c truy v·∫•n n√†y c√≥ th·ªÉ m·∫•t r·∫•t nhi·ªÅu th·ªùi gian, t√πy thu·ªôc v√†o k√≠ch th∆∞·ªõc c·ªßa t·∫≠p h·ª£p con m√† ch√∫ng ta ƒëang kh√°m ph√° v√† do ƒë√≥ kh√¥ng th·ªëng nh·∫•t (kh√¥ng gi·ªëng nh∆∞ c√°c OLTP queries).   

T√¥i hy v·ªçng r·∫±ng b√†i vi·∫øt n√†y ƒë√£ gi√∫p b·∫°n hi·ªÉu ƒë∆∞·ª£c s·ª± kh√°c nhau c·ªßa c√°c h·ªá th·ªëng OLTP v√† OLAP v√† c·∫£ c√°ch ch√∫ng l√†m vi·ªác c√πng nhau. Ch√∫ng kh√¥ng ph·ªß ƒë·ªãnh nhau m√† l√† m·ªôt c·∫∑p t·ªìn t·∫°i song song, h·ªó tr·ª£, b√π tr·ª´ cho nhau.   

Credit: viblo.asia   